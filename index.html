<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeuroForge | AI-Powered Security Scanner</title>
    <!-- PWA Features -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <meta name="apple-mobile-web-app-status-bar" content="#2563eb">
    <meta name="theme-color" content="#2563eb">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- TensorFlow.js for machine learning -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.18.0/dist/tf.min.js"></script>
    <!-- Natural language processing for threat analysis -->
    <script src="https://cdn.jsdelivr.net/npm/compromise@14.8.4/builds/compromise.min.js"></script>
    
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #0f172a;
            --light: #f8fafc;
            --cyber-blue: #0ea5e9;
            --cyber-purple: #8b5cf6;
            --cyber-green: #22c55e;
            --neural-pink: #ec4899;
            --neural-purple: #a855f7;
            --card-bg: rgba(30, 41, 59, 0.95);
            --header-height: 70px;
            --glow: 0 0 15px rgba(14, 165, 233, 0.5);
            --ai-gradient: linear-gradient(135deg, #4a00e0, #8e2de2);
            --neural-gradient: linear-gradient(135deg, var(--neural-pink), var(--neural-purple));
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f172a, #1e293b);
            color: var(--light);
            min-height: 100vh;
            padding: 0;
            overflow-x: hidden;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header */
        header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: var(--header-height);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-icon {
            background: var(--neural-gradient);
            width: 42px;
            height: 42px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            box-shadow: 0 0 15px rgba(236, 72, 153, 0.5);
        }
        
        .logo-text {
            display: flex;
            flex-direction: column;
        }
        
        .logo h1 {
            font-size: 22px;
            font-weight: 800;
            background: var(--neural-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        /* Navigation */
        .nav-links {
            display: flex;
            gap: 25px;
        }
        
        .nav-link {
            color: #94a3b8;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }
        
        .nav-link:hover {
            color: var(--light);
        }
        
        /* Hero Section */
        .hero-section {
            padding-top: calc(var(--header-height) + 40px);
            padding: 100px 20px 60px;
            text-align: center;
            max-width: 900px;
            margin: 0 auto;
        }
        
        .hero-title {
            font-size: 42px;
            font-weight: 800;
            margin-bottom: 20px;
            background: var(--neural-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1.2;
        }
        
        .hero-subtitle {
            font-size: 20px;
            color: #94a3b8;
            margin-bottom: 40px;
        }
        
        .url-input-container {
            max-width: 800px;
            margin: 40px auto;
            background: rgba(15, 23, 42, 0.7);
            padding: 25px;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .url-input {
            width: 100%;
            padding: 16px 20px;
            border-radius: 12px;
            border: 2px solid rgba(148, 163, 184, 0.3);
            background: rgba(15, 23, 42, 0.8);
            color: var(--light);
            font-size: 16px;
            outline: none;
        }
        
        .url-input:focus {
            border-color: var(--neural-pink);
            box-shadow: 0 0 15px rgba(236, 72, 153, 0.5);
        }
        
        .test-btn {
            padding: 16px 30px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            background: var(--neural-gradient);
            color: white;
            box-shadow: 0 0 20px rgba(236, 72, 153, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .test-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(236, 72, 153, 0.7);
        }
        
        .test-btn.running {
            background: linear-gradient(to right, var(--warning), var(--danger));
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .status-message {
            padding: 15px;
            border-radius: 12px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status-info {
            background: rgba(14, 165, 233, 0.1);
            border-left: 4px solid var(--cyber-blue);
        }
        
        .status-success {
            background: rgba(16, 185, 129, 0.1);
            border-left: 4px solid var(--secondary);
        }
        
        .status-warning {
            background: rgba(245, 158, 11, 0.1);
            border-left: 4px solid var(--warning);
        }
        
        .status-error {
            background: rgba(239, 68, 68, 0.1);
            border-left: 4px solid var(--danger);
        }
        
        /* Dashboard */
        .dashboard {
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .card.neural-card {
            border: 1px solid rgba(236, 72, 153, 0.3);
            box-shadow: 0 10px 30px rgba(236, 72, 153, 0.2);
        }
        
        .card-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .card-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--light);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-title i {
            color: var(--cyber-blue);
        }
        
        .card-title .neural-icon {
            color: var(--neural-pink);
        }
        
        .progress-container {
            margin: 25px 0;
        }
        
        .progress-bar {
            height: 16px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--danger), var(--warning), var(--secondary));
            border-radius: 10px;
            width: 0%;
            transition: width 1s ease;
        }
        
        .progress-labels {
            display: flex;
            justify-content: space-between;
            color: #94a3b8;
            font-size: 14px;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .result-card {
            background: rgba(15, 23, 42, 0.7);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .result-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .result-value {
            font-size: 32px;
            font-weight: 800;
            margin: 10px 0;
        }
        
        .result-label {
            color: #94a3b8;
            font-size: 14px;
        }
        
        .result-critical {
            color: var(--danger);
        }
        
        .result-high {
            color: var(--warning);
        }
        
        .result-medium {
            color: #84cc16;
        }
        
        .result-low {
            color: var(--cyber-blue);
        }
        
        /* Vulnerability List */
        .vulnerability-list {
            margin-top: 25px;
        }
        
        .vulnerability-item {
            background: rgba(15, 23, 42, 0.7);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid var(--danger);
            transition: all 0.3s ease;
        }
        
        .vulnerability-item.warning {
            border-left-color: var(--warning);
        }
        
        .vulnerability-item.success {
            border-left-color: var(--secondary);
        }
        
        .vulnerability-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .vulnerability-title {
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .vulnerability-desc {
            color: #94a3b8;
            margin-top: 10px;
            line-height: 1.6;
            font-size: 14px;
        }
        
        .vulnerability-severity {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .severity-critical {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }
        
        .severity-high {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }
        
        .severity-medium {
            background: rgba(101, 163, 13, 0.2);
            color: #84cc16;
        }
        
        .severity-low {
            background: rgba(59, 130, 246, 0.2);
            color: var(--cyber-blue);
        }
        
        /* Heatmap */
        .heatmap-container {
            margin: 30px 0;
            padding: 20px;
            background: rgba(15, 23, 42, 0.8);
            border-radius: 16px;
            border: 1px solid rgba(139, 92, 246, 0.3);
        }
        
        .heatmap-title {
            text-align: center;
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--light);
        }
        
        .heatmap-grid {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 4px;
            max-width: 100%;
            margin: 0 auto;
        }
        
        .heatmap-cell {
            aspect-ratio: 1/1;
            border-radius: 4px;
            transition: all 0.3s ease;
        }
        
        .heatmap-cell:hover {
            transform: scale(1.2);
            z-index: 2;
        }
        
        .severity-0 { background: rgba(16, 185, 129, 0.1); }
        .severity-1 { background: rgba(59, 130, 246, 0.3); }
        .severity-2 { background: rgba(101, 163, 13, 0.5); }
        .severity-3 { background: rgba(245, 158, 11, 0.7); }
        .severity-4 { background: rgba(239, 68, 68, 0.9); }
        
        /* Proprietary Section */
        .proprietary-section {
            margin: 40px 0;
            padding: 30px;
            background: linear-gradient(135deg, rgba(236, 72, 153, 0.1), rgba(168, 85, 247, 0.1));
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .section-title {
            text-align: center;
            font-size: 24px;
            margin-bottom: 25px;
            color: var(--light);
            font-weight: 700;
        }
        
        .innovation-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        .innovation-card {
            background: rgba(15, 23, 42, 0.7);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: transform 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .innovation-card:hover {
            transform: translateY(-5px);
            border-color: var(--neural-purple);
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.5);
        }
        
        .innovation-icon {
            font-size: 36px;
            margin-bottom: 15px;
            color: var(--neural-purple);
        }
        
        .innovation-card h3 {
            color: var(--light);
            margin-bottom: 10px;
            font-size: 18px;
        }
        
        .innovation-card p {
            color: #94a3b8;
            font-size: 15px;
            line-height: 1.6;
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 30px 20px;
            color: #94a3b8;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 40px;
            font-size: 14px;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin: 15px 0;
        }
        
        .footer-link {
            color: var(--cyber-blue);
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .footer-link:hover {
            text-decoration: underline;
        }
        
        /* Threat Analysis Section */
        .threat-analysis {
            margin: 30px 0;
            padding: 20px;
            background: rgba(15, 23, 42, 0.8);
            border-radius: 16px;
            border: 1px solid rgba(142, 45, 226, 0.3);
        }
        
        .threat-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .threat-icon {
            font-size: 24px;
            color: #8e2de2;
        }
        
        .threat-title {
            font-size: 18px;
            font-weight: 700;
            background: var(--ai-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .threat-content {
            padding: 15px;
            background: rgba(30, 41, 59, 0.6);
            border-radius: 12px;
            margin-top: 10px;
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 14px;
            line-height: 1.5;
            white-space: pre-wrap;
        }
        
        .threat-loader {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            padding: 10px;
        }
        
        .threat-loader .dot {
            width: 8px;
            height: 8px;
            background: #8e2de2;
            border-radius: 50%;
            animation: bounce 1.5s infinite;
        }
        
        .threat-loader .dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .threat-loader .dot:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }
        
        /* Proxy toggle */
        .proxy-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            color: #94a3b8;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .switch input { 
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background: var(--neural-pink);
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .tech-pill {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-top: 8px;
            background: rgba(236, 72, 153, 0.15);
            color: var(--neural-pink);
        }
        
        .disclaimer {
            background: rgba(245, 158, 11, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 14px;
            border-left: 3px solid var(--warning);
        }
        
        /* Neural Network Visualization */
        .neural-network {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 120px;
            margin: 20px 0;
            position: relative;
        }
        
        .neural-layer {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-around;
            height: 100%;
            margin: 0 15px;
            position: relative;
        }
        
        .neural-node {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--neural-pink);
            margin: 8px 0;
            position: relative;
            box-shadow: 0 0 10px rgba(236, 72, 153, 0.5);
        }
        
        .neural-connection {
            position: absolute;
            background: linear-gradient(to right, rgba(236, 72, 153, 0.3), rgba(168, 85, 247, 0.3));
            transform-origin: 0 50%;
            z-index: -1;
        }
        
        .neural-node.active {
            background: var(--neural-purple);
            box-shadow: 0 0 15px rgba(168, 85, 247, 0.7);
            animation: pulse 1.5s infinite;
        }
        
        /* ML Results */
        .ml-results {
            margin-top: 20px;
            padding: 15px;
            background: rgba(15, 23, 42, 0.7);
            border-radius: 12px;
            border: 1px solid rgba(236, 72, 153, 0.3);
        }
        
        .ml-result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .ml-result-item:last-child {
            border-bottom: none;
        }
        
        .ml-result-label {
            color: #94a3b8;
        }
        
        .ml-result-value {
            font-weight: 600;
            color: var(--light);
        }
        
        .ml-confidence {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .confidence-bar {
            width: 100px;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .confidence-fill {
            height: 100%;
            background: var(--neural-gradient);
            border-radius: 3px;
            width: 0%;
            transition: width 1s ease;
        }
        
        /* Progress Steps */
        .progress-steps {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            position: relative;
        }
        
        .progress-steps::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-50%);
            z-index: 1;
        }
        
        .progress-step {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            position: relative;
            z-index: 2;
            transition: all 0.3s ease;
        }
        
        .progress-step.active {
            background: var(--neural-pink);
            box-shadow: 0 0 10px rgba(236, 72, 153, 0.5);
        }
        
        .progress-step.completed {
            background: var(--secondary);
        }
        
        /* Scan History */
        .scan-history {
            margin: 40px 0;
        }
        
        .history-item {
            background: rgba(15, 23, 42, 0.7);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 4px solid var(--cyber-blue);
        }
        
        .history-url {
            font-weight: 500;
        }
        
        .history-date {
            color: #94a3b8;
            font-size: 14px;
        }
        
        /* Export Section */
        .export-section {
            margin: 30px 0;
            text-align: center;
        }
        
        .export-btn {
            padding: 12px 25px;
            background: rgba(14, 165, 233, 0.1);
            border: 1px solid var(--cyber-blue);
            color: var(--cyber-blue);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .export-btn:hover {
            background: rgba(14, 165, 233, 0.2);
        }
        
        /* Responsive Adjustments */
        @media (min-width: 768px) {
            .input-group {
                flex-direction: row;
            }
            
            .url-input {
                font-size: 16px;
            }
            
            .test-btn {
                padding: 16px 40px;
            }
            
            .dashboard {
                grid-template-columns: 1fr 1fr;
            }
            
            .results-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .innovation-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .nav-links {
                display: flex;
            }
        }
        
        @media (min-width: 992px) {
            .container {
                padding: 0 30px;
            }
            
            .hero-title {
                font-size: 48px;
            }
        }
        
        /* Mobile menu */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }
        
        @media (max-width: 767px) {
            .nav-links {
                display: none;
                position: absolute;
                top: var(--header-height);
                left: 0;
                right: 0;
                background: rgba(15, 23, 42, 0.95);
                flex-direction: column;
                padding: 20px;
                border-top: 1px solid rgba(255, 255, 255, 0.1);
            }
            
            .nav-links.active {
                display: flex;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .results-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .innovation-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Animation enhancements */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        .delay-1 { animation-delay: 0.1s; }
        .delay-2 { animation-delay: 0.2s; }
        .delay-3 { animation-delay: 0.3s; }
        .delay-4 { animation-delay: 0.4s; }
        
        /* Detailed report view */
        .detailed-view {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
        }
        
        .detailed-view.active {
            max-height: 500px;
        }
        
        .view-toggle {
            background: none;
            border: none;
            color: var(--cyber-blue);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 10px;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(15, 23, 42, 0.5);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--neural-pink);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--neural-purple);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-brain"></i>
                </div>
                <div class="logo-text">
                    <h1>NeuroForge</h1>
                </div>
            </div>
            
            <div class="nav-links">
                <a href="#" class="nav-link">Home</a>
                <a href="#" class="nav-link">Features</a>
                <a href="#" class="nav-link">Pricing</a>
                <a href="#" class="nav-link">Docs</a>
                <a href="#" class="nav-link">Contact</a>
            </div>
            
            <button class="mobile-menu-btn" id="mobile-menu-btn">
                <i class="fas fa-bars"></i>
            </button>
        </header>
        
        <!-- Hero Section -->
        <section class="hero-section">
            <h2 class="hero-title">AI-Powered Security Scanner</h2>
            <p class="hero-subtitle">Next-generation vulnerability detection with machine learning</p>
            
            <div class="url-input-container fade-in">
                <div class="input-group">
                    <input type="url" class="url-input" id="app-url" placeholder="https://example.com" value="https://example.com">
                    <button class="test-btn" id="test-btn">
                        <i class="fas fa-brain"></i> Run AI Security Analysis
                    </button>
                </div>
                <p>Enter any website URL to perform advanced AI-powered security assessment</p>
                
                <div class="proxy-toggle">
                    <span>Enable neural analysis:</span>
                    <label class="switch">
                        <input type="checkbox" id="neural-toggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="disclaimer">
                    <i class="fas fa-exclamation-circle"></i>
                    This tool performs security analysis only. Always obtain proper authorization before scanning websites.
                </div>
                
                <div class="status-message status-info" id="status-message">
                    <i class="fas fa-info-circle"></i>
                    <span>Enter URL and click "Run AI Security Analysis" to begin</span>
                </div>

                <div class="progress-steps" id="progress-steps">
                    <div class="progress-step" id="step-1">1</div>
                    <div class="progress-step" id="step-2">2</div>
                    <div class="progress-step" id="step-3">3</div>
                    <div class="progress-step" id="step-4">4</div>
                    <div class="progress-step" id="step-5">5</div>
                </div>
            </div>
        </section>
        
        <!-- Neural Network Visualization -->
        <div class="neural-network" id="neural-network">
            <!-- Will be populated by JavaScript -->
        </div>
        
        <!-- Proprietary Technology -->
        <section class="proprietary-section fade-in">
            <h2 class="section-title">Proprietary AI Technology</h2>
            
            <div class="innovation-grid">
                <div class="innovation-card delay-1">
                    <div class="innovation-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <h3>Neural Vulnerability Detection</h3>
                    <p>Patented machine learning algorithms that detect novel vulnerabilities through behavioral analysis.</p>
                    <div class="tech-pill">PATENT PENDING</div>
                </div>
                
                <div class="innovation-card delay-2">
                    <div class="innovation-icon">
                        <i class="fas fa-project-diagram"></i>
                    </div>
                    <h3>Adaptive Threat Modeling</h3>
                    <p>AI that builds dynamic threat models based on real-time analysis of application architecture.</p>
                    <div class="tech-pill">EXCLUSIVE</div>
                </div>
                
                <div class="innovation-card delay-3">
                    <div class="innovation-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3>Zero-Day Prediction</h3>
                    <p>Proprietary algorithms that identify patterns indicative of previously unknown vulnerabilities.</p>
                    <div class="tech-pill">INNOVATIVE</div>
                </div>

                <!-- Additional cards from CyberForge -->
                <div class="innovation-card delay-1">
                    <div class="innovation-icon">
                        <i class="fas fa-brain"></i>
                    </div>
                    <h3>Behavioral Analysis Engine</h3>
                    <p>Patented algorithms that detect vulnerabilities by analyzing runtime behavior patterns.</p>
                    <div class="tech-pill">PATENTED</div>
                </div>
                
                <div class="innovation-card delay-2">
                    <div class="innovation-icon">
                        <i class="fas fa-project-diagram"></i>
                    </div>
                    <h3>Cross-Origin Scanning</h3>
                    <p>Proprietary technology to securely analyze content across domains without CORS limitations.</p>
                    <div class="tech-pill">EXCLUSIVE</div>
                </div>
                
                <div class="innovation-card delay-3">
                    <div class="innovation-icon">
                        <i class="fas fa-lock"></i>
                    </div>
                    <h3>Zero-Day Detection</h3>
                    <p>Advanced heuristics to identify previously unknown vulnerabilities in modern frameworks.</p>
                    <div class="tech-pill">INNOVATIVE</div>
                </div>
            </div>
        </section>
        
        <!-- Dashboard -->
        <div class="dashboard">
            <div class="card neural-card fade-in">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-brain neural-icon"></i> AI Security Report</h2>
                    <span id="report-status">Ready to scan</span>
                </div>
                
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="security-score-bar"></div>
                    </div>
                    <div class="progress-labels">
                        <span>Low Security</span>
                        <span id="security-score-value">0%</span>
                        <span>High Security</span>
                    </div>
                </div>
                
                <div class="results-grid">
                    <div class="result-card">
                        <div class="result-value result-critical" id="critical-count">0</div>
                        <div class="result-label">Critical Vulnerabilities</div>
                    </div>
                    <div class="result-card">
                        <div class="result-value result-high" id="high-count">0</div>
                        <div class="result-label">High Severity</div>
                    </div>
                    <div class="result-card">
                        <div class="result-value result-medium" id="medium-count">0</div>
                        <div class="result-label">Medium Issues</div>
                    </div>
                    <div class="result-card">
                        <div class="result-value result-low" id="low-count">0</div>
                        <div class="result-label">Low Severity</div>
                    </div>
                </div>
                
                <!-- ML Results -->
                <div class="ml-results">
                    <h3 class="card-title"><i class="fas fa-microchip neural-icon"></i> AI Analysis</h3>
                    <div class="ml-result-item">
                        <span class="ml-result-label">Vulnerability Prediction Confidence</span>
                        <div class="ml-confidence">
                            <div class="confidence-bar">
                                <div class="confidence-fill" id="confidence-level"></div>
                            </div>
                            <span class="ml-result-value" id="confidence-value">0%</span>
                        </div>
                    </div>
                    <div class="ml-result-item">
                        <span class="ml-result-label">Anomaly Detection Score</span>
                        <span class="ml-result-value" id="anomaly-score">0.00</span>
                    </div>
                    <div class="ml-result-item">
                        <span class="ml-result-label">Threat Intelligence Match</span>
                        <span class="ml-result-value" id="threat-match">No matches</span>
                    </div>
                </div>
                
                <div class="vulnerability-list" id="vulnerability-list">
                    <div class="vulnerability-item">
                        <div class="vulnerability-header">
                            <div class="vulnerability-title">
                                <i class="fas fa-shield-alt"></i>
                                <span>Run security tests to discover vulnerabilities</span>
                            </div>
                        </div>
                        <div class="vulnerability-desc">
                            Enter a URL and click "Run AI Security Analysis" to begin security assessment
                        </div>
                    </div>
                </div>
                
                <!-- Threat Analysis Section -->
                <div class="threat-analysis">
                    <div class="threat-header">
                        <i class="fas fa-brain threat-icon"></i>
                        <h3 class="threat-title">AI Threat Analysis Report</h3>
                    </div>
                    <div class="threat-content" id="threat-content">
                        AI security analysis will appear here after scan completes.
                    </div>
                </div>
                
                <!-- Export Section -->
                <div class="export-section">
                    <button class="export-btn" id="export-btn">
                        <i class="fas fa-download"></i> Export Full Report
                    </button>
                </div>
            </div>
            
            <div class="card fade-in delay-1">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-bug"></i> Vulnerability Analysis</h2>
                    <span>Detailed results</span>
                </div>
                
                <!-- Vulnerability Heatmap -->
                <div class="heatmap-container">
                    <h3 class="heatmap-title">Vulnerability Distribution</h3>
                    <div class="heatmap-grid" id="heatmap-grid">
                        <!-- Heatmap cells will be generated by JS -->
                    </div>
                </div>
                
                <div class="card-header" style="margin-top: 30px;">
                    <h2 class="card-title"><i class="fas fa-network-wired"></i> Security Protocols</h2>
                    <span>Connection security</span>
                </div>
                
                <div class="results-grid">
                    <div class="result-card">
                        <div class="result-value" id="https-status">❓</div>
                        <div class="result-label">HTTPS</div>
                    </div>
                    <div class="result-card">
                        <div class="result-value" id="hsts-status">❓</div>
                        <div class="result-label">HSTS</div>
                    </div>
                    <div class="result-card">
                        <div class="result-value" id="csp-status">❓</div>
                        <div class="result-label">CSP</div>
                    </div>
                    <div class="result-card">
                        <div class="result-value" id="xfo-status">❓</div>
                        <div class="result-label">X-Frame-Options</div>
                    </div>
                </div>
                
                <div class="card-header" style="margin-top: 30px;">
                    <h2 class="card-title"><i class="fas fa-microchip"></i> Advanced Detection</h2>
                    <span>Technology analysis</span>
                </div>
                
                <div class="results-grid">
                    <div class="result-card">
                        <div class="result-value" id="shadow-dom">❓</div>
                        <div class="result-label">Shadow DOM</div>
                    </div>
                    <div class="result-card">
                        <div class="result-value" id="web-components">❓</div>
                        <div class="result-label">Web Components</div>
                    </div>
                    <div class="result-card">
                        <div class="result-value" id="js-frameworks">❓</div>
                        <div class="result-label">JS Frameworks</div>
                    </div>
                    <div class="result-card">
                        <div class="result-value" id="obfuscation">❓</div>
                        <div class="result-label">Obfuscation</div>
                    </div>
                </div>
                
                <!-- Scan History -->
                <div class="card-header" style="margin-top: 30px;">
                    <h2 class="card-title"><i class="fas fa-history"></i> Recent Scans</h2>
                    <span>Last 5 scans</span>
                </div>
                
                <div class="scan-history" id="scan-history">
                    <div class="history-item">
                        <span class="history-url">No scans yet</span>
                        <span class="history-date">-</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <footer class="fade-in delay-2">
            <h3>NeuroForge AI Security Platform</h3>
            <p>Next-generation security scanning with machine learning</p>
            
            <div class="footer-links">
                <a href="#" class="footer-link">Privacy Policy</a>
                <a href="#" class="footer-link">Terms of Service</a>
                <a href="#" class="footer-link">How It Works</a>
                <a href="#" class="footer-link">Contact Us</a>
            </div>
            
            <p>&copy; 2023 NeuroForge Inc. All rights reserved. | Version 2.0.0</p>
        </footer>
    </div>
    
    <script>
        // Enhanced AI-Powered Security Scanner Implementation
        class NeuroForgeScanner {
            constructor() {
                this.vulnerabilities = [];
                this.securityScore = 100;
                this.threatAnalysis = "";
                this.advancedMetrics = {
                    shadowDom: false,
                    webComponents: false,
                    jsFrameworks: [],
                    obfuscationLevel: 0
                };
                this.currentStep = 0;
                this.corsProxies = [
                    'https://api.allorigins.win/raw?url=',
                    'https://corsproxy.io/?',
                    'https://cors-anywhere.herokuapp.com/'
                ];
                this.technicalDetails = {};
                this.mlModel = null;
                this.nlp = null;
                this.scanHistory = JSON.parse(localStorage.getItem('scanHistory')) || [];
                
                // Initialize ML and NLP
                this.initMachineLearning();
                this.updateScanHistoryUI();
            }
            
            // Update scan history UI
            updateScanHistoryUI() {
                const historyContainer = document.getElementById('scan-history');
                historyContainer.innerHTML = '';
                
                if (this.scanHistory.length === 0) {
                    historyContainer.innerHTML = `
                        <div class="history-item">
                            <span class="history-url">No scans yet</span>
                            <span class="history-date">-</span>
                        </div>
                    `;
                    return;
                }
                
                // Show last 5 scans
                const recentScans = this.scanHistory.slice(-5).reverse();
                
                recentScans.forEach(scan => {
                    const historyItem = document.createElement('div');
                    historyItem.className = 'history-item';
                    historyItem.innerHTML = `
                        <span class="history-url">${scan.url}</span>
                        <span class="history-date">${new Date(scan.timestamp).toLocaleDateString()}</span>
                    `;
                    historyContainer.appendChild(historyItem);
                });
            }
            
            // Add scan to history
            addToHistory(url) {
                this.scanHistory.push({
                    url: url,
                    timestamp: new Date().toISOString()
                });
                
                // Keep only last 20 scans
                if (this.scanHistory.length > 20) {
                    this.scanHistory = this.scanHistory.slice(-20);
                }
                
                localStorage.setItem('scanHistory', JSON.stringify(this.scanHistory));
                this.updateScanHistoryUI();
            }
            
            // Initialize machine learning components
            async initMachineLearning() {
                try {
                    // Load compromise.js for NLP
                    this.nlp = window.nlp;
                    
                    // Create a simple neural network for vulnerability detection
                    this.mlModel = tf.sequential();
                    this.mlModel.add(tf.layers.dense({units: 32, activation: 'relu', inputShape: [10]}));
                    this.mlModel.add(tf.layers.dense({units: 16, activation: 'relu'}));
                    this.mlModel.add(tf.layers.dense({units: 8, activation: 'relu'}));
                    this.mlModel.add(tf.layers.dense({units: 1, activation: 'sigmoid'}));
                    
                    this.mlModel.compile({
                        optimizer: 'adam',
                        loss: 'binaryCrossentropy',
                        metrics: ['accuracy']
                    });
                    
                    // Pre-train with some basic patterns
                    const xs = tf.tensor2d([
                        [1, 0, 0, 1, 0, 1, 0, 0, 1, 0], // Pattern indicating potential vulnerability
                        [0, 1, 1, 0, 1, 0, 1, 1, 0, 1], // Pattern indicating secure
                        [1, 1, 0, 1, 0, 0, 1, 0, 1, 1], // Mixed pattern
                        [0, 0, 1, 0, 1, 1, 0, 1, 0, 0], // Secure pattern
                        [1, 0, 1, 1, 0, 1, 0, 1, 1, 0]  // Vulnerability pattern
                    ]);
                    
                    const ys = tf.tensor2d([
                        [1], [0], [0.5], [0], [1]
                    ]);
                    
                    // Train the model
                    await this.mlModel.fit(xs, ys, {
                        epochs: 100,
                        verbose: 0
                    });
                    
                    console.log("ML model initialized and trained");
                } catch (error) {
                    console.error("Failed to initialize ML model:", error);
                }
            }
            
            // Update progress steps
            updateProgress(step) {
                const steps = document.querySelectorAll('.progress-step');
                steps.forEach((s, i) => {
                    if (i < step) {
                        s.classList.add('completed');
                        s.classList.remove('active');
                    } else if (i === step) {
                        s.classList.add('active');
                        s.classList.remove('completed');
                    } else {
                        s.classList.remove('active', 'completed');
                    }
                });
                this.currentStep = step;
            }
            
            // Create neural network visualization
            createNeuralVisualization() {
                const container = document.getElementById('neural-network');
                container.innerHTML = '';
                
                // Create layers
                for (let i = 0; i < 4; i++) {
                    const layer = document.createElement('div');
                    layer.className = 'neural-layer';
                    
                    // Create nodes for this layer
                    const nodeCount = i === 0 ? 4 : i === 3 ? 3 : 5;
                    for (let j = 0; j < nodeCount; j++) {
                        const node = document.createElement('div');
                        node.className = 'neural-node';
                        if (i === 0 && j === 0) node.classList.add('active');
                        layer.appendChild(node);
                    }
                    
                    container.appendChild(layer);
                }
                
                // Animate the neural network
                this.animateNeuralNetwork();
            }
            
            // Animate neural network
            animateNeuralNetwork() {
                const nodes = document.querySelectorAll('.neural-node');
                let current = 0;
                
                const animate = () => {
                    if (current >= nodes.length) current = 0;
                    
                    nodes.forEach(node => node.classList.remove('active'));
                    nodes[current].classList.add('active');
                    
                    current++;
                    setTimeout(animate, 200);
                };
                
                animate();
            }
            
            // Try multiple CORS proxies until one works
            async fetchWithCorsProxies(url, options = {}) {
                const useProxy = document.getElementById('neural-toggle').checked;
                if (!useProxy) {
                    // Try direct access first
                    try {
                        const response = await fetch(url, {
                            ...options,
                            mode: 'cors',
                            headers: {
                                'Accept': 'text/html,application/xhtml+xml,application/xml',
                                ...options.headers
                            }
                        });
                        if (response.ok) return response;
                        throw new Error(`Direct access failed: ${response.status}`);
                    } catch (error) {
                        console.log('Direct access failed, trying proxies...');
                    }
                }
                
                // Try each proxy
                for (const proxy of this.corsProxies) {
                    try {
                        const proxyUrl = proxy + encodeURIComponent(url);
                        const response = await fetch(proxyUrl, {
                            ...options,
                            headers: {
                                'Accept': 'text/html,application/xhtml+xml,application/xml',
                                ...options.headers
                            }
                        });
                        if (response.ok) return response;
                    } catch (e) {
                        console.log(`Proxy ${proxy} failed, trying next...`);
                    }
                }
                throw new Error('All CORS proxies failed');
            }
            
            // Perform AI-powered security scan
            async scan(url) {
                this.vulnerabilities = [];
                this.securityScore = 100;
                this.threatAnalysis = "";
                this.advancedMetrics = {
                    shadowDom: false,
                    webComponents: false,
                    jsFrameworks: [],
                    obfuscationLevel: 0
                };
                this.technicalDetails = {
                    url: url,
                    timestamp: new Date().toISOString(),
                    headers: {},
                    findings: [],
                    mlAnalysis: {}
                };
                
                // Add to scan history
                this.addToHistory(url);
                
                // Create neural visualization
                this.createNeuralVisualization();
                
                // Update status
                this.updateProgress(1);
                document.getElementById('status-message').innerHTML = '<i class="fas fa-sync fa-spin"></i> Initializing AI security scan...';
                
                try {
                    // Step 1: Check if URL is valid and accessible
                    this.updateProgress(2);
                    document.getElementById('status-message').innerHTML = '<i class="fas fa-sync fa-spin"></i> Checking URL accessibility...';
                    
                    // Use a proxy to bypass CORS limitations
                    const response = await this.fetchWithCorsProxies(url, {
                        method: 'GET',
                        headers: {
                            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'
                        }
                    });
                    
                    if (!response.ok) {
                        throw new Error(`Failed to access URL: ${response.status} ${response.statusText}`);
                    }
                    
                    // Store headers for technical details
                    this.technicalDetails.headers = {};
                    response.headers.forEach((value, key) => {
                        this.technicalDetails.headers[key] = value;
                    });
                    
                    // Step 2: Analyze headers
                    this.updateProgress(3);
                    document.getElementById('status-message').innerHTML = '<i class="fas fa-sync fa-spin"></i> Analyzing security headers with AI...';
                    this.analyzeHeaders(response.headers, url);
                    
                    // Step 3: Analyze content
                    this.updateProgress(4);
                    document.getElementById('status-message').innerHTML = '<i class="fas fa-sync fa-spin"></i> Analyzing page content with neural networks...';
                    const html = await response.text();
                    await this.analyzeContent(html, url);
                    
                    // Step 4: Analyze security protocols
                    this.analyzeSecurityProtocols(url);
                    
                    // Step 5: Check for additional vulnerabilities
                    await this.checkAdditionalVulnerabilities(url);
                    
                    // Step 6: Generate threat analysis with AI
                    this.generateAIThreatAnalysis();
                    
                    this.updateProgress(5);
                    document.getElementById('status-message').innerHTML = '<i class="fas fa-check-circle"></i> AI security scan completed!';
                    
                } catch (error) {
                    throw new Error(`Scan failed: ${error.message}`);
                }
                
                return {
                    score: this.securityScore,
                    vulnerabilities: this.vulnerabilities,
                    threatAnalysis: this.threatAnalysis,
                    advancedMetrics: this.advancedMetrics,
                    technicalDetails: this.technicalDetails
                };
            }
            
            // Analyze HTTP headers for security features with ML
            analyzeHeaders(headers, url) {
                const securityHeaders = [
                    'content-security-policy',
                    'strict-transport-security',
                    'x-content-type-options',
                    'x-frame-options',
                    'x-xss-protection',
                    'referrer-policy',
                    'permissions-policy',
                    'cross-origin-opener-policy',
                    'cross-origin-embedder-policy',
                    'cross-origin-resource-policy'
                ];
                
                // Update UI elements based on header presence
                document.getElementById('hsts-status').textContent = headers.has('strict-transport-security') ? '✅' : '❌';
                document.getElementById('csp-status').textContent = headers.has('content-security-policy') ? '✅' : '❌';
                document.getElementById('xfo-status').textContent = headers.has('x-frame-options') ? '✅' : '❌';
                
                securityHeaders.forEach(header => {
                    if (!headers.get(header)) {
                        let severity = 'medium';
                        let points = 10;
                        
                        if (header === 'content-security-policy' || header === 'strict-transport-security') {
                            severity = 'high';
                            points = 15;
                        }
                        
                        this.addVulnerability({
                            type: 'header',
                            name: `Missing ${header.toUpperCase()} Header`,
                            severity: severity,
                            description: `The ${header.toUpperCase()} header is missing, which could expose your site to various attacks.`,
                            recommendation: `Add the ${header.toUpperCase()} header with appropriate security values.`,
                            points: points
                        });

                        this.technicalDetails.findings.push({
                            type: 'missing_header',
                            header: header,
                            severity: severity
                        });
                    } else {
                        // Analyze header values
                        const value = headers.get(header);
                        this.analyzeHeaderValue(header, value);
                    }
                });
            }
            
            // Analyze header values for misconfigurations with ML
            analyzeHeaderValue(header, value) {
                // CSP analysis
                if (header === 'content-security-policy') {
                    const directives = value.split(';');
                    let hasUnsafeInline = false;
                    let hasUnsafeEval = false;
                    
                    directives.forEach(dir => {
                        if (dir.includes('unsafe-inline')) {
                            hasUnsafeInline = true;
                        }
                        if (dir.includes('unsafe-eval')) {
                            hasUnsafeEval = true;
                        }
                    });
                    
                    if (hasUnsafeInline) {
                        this.addVulnerability({
                            type: 'header',
                            name: 'CSP Contains unsafe-inline',
                            severity: 'medium',
                            description: 'The Content Security Policy contains unsafe-inline, which reduces protection against XSS attacks.',
                            recommendation: 'Remove unsafe-inline from CSP and use nonces or hashes instead.',
                            points: 8
                        });

                        this.technicalDetails.findings.push({
                            type: 'csp_unsafe_inline',
                            severity: 'medium'
                        });
                    }
                    
                    if (hasUnsafeEval) {
                        this.addVulnerability({
                            type: 'header',
                            name: 'CSP Contains unsafe-eval',
                            severity: 'medium',
                            description: 'The Content Security Policy contains unsafe-eval, which allows execution of dynamic code.',
                            recommendation: 'Remove unsafe-eval from CSP to prevent code injection attacks.',
                            points: 8
                        });

                        this.technicalDetails.findings.push({
                            type: 'csp_unsafe_eval',
                            severity: 'medium'
                        });
                    }
                }
                
                // HSTS analysis
                if (header === 'strict-transport-security') {
                    if (!value.includes('max-age') || value.includes('max-age=0')) {
                        this.addVulnerability({
                            type: 'header',
                            name: 'HSTS Misconfiguration',
                            severity: 'high',
                            description: 'HSTS header is missing max-age or is set to 0, which disables HSTS protection.',
                            recommendation: 'Set HSTS with max-age of at least 31536000 (1 year) and includeSubDomains.',
                            points: 12
                        });

                        this.technicalDetails.findings.push({
                            type: 'hsts_misconfiguration',
                            severity: 'high'
                        });
                    }
                    
                    if (!value.includes('includeSubDomains')) {
                        this.addVulnerability({
                            type: 'header',
                            name: 'HSTS Missing includeSubDomains',
                            severity: 'medium',
                            description: 'HSTS header does not include subdomains, leaving them unprotected.',
                            recommendation: 'Add includeSubDomains to HSTS header for comprehensive protection.',
                            points: 7
                        });

                        this.technicalDetails.findings.push({
                            type: 'hsts_no_includesubdomains',
                            severity: 'medium'
                        });
                    }
                }
                
                // X-Frame-Options analysis
                if (header === 'x-frame-options') {
                    const validValues = ['DENY', 'SAMEORIGIN'];
                    if (!validValues.includes(value.toUpperCase())) {
                        this.addVulnerability({
                            type: 'header',
                            name: 'X-Frame-Options Misconfiguration',
                            severity: 'medium',
                            description: 'X-Frame-Options header has an invalid value.',
                            recommendation: 'Set X-Frame-Options to either DENY or SAMEORIGIN.',
                            points: 8
                        });

                        this.technicalDetails.findings.push({
                            type: 'xframe_options_misconfiguration',
                            severity: 'medium'
                        });
                    }
                }
            }
            
            // Analyze HTML content for vulnerabilities with ML
            async analyzeContent(html, url) {
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                
                // Store HTML for technical details
                this.technicalDetails.html = html.substring(0, 1000) + (html.length > 1000 ? '...' : '');
                
                // Check for insecure forms
                const forms = doc.querySelectorAll('form');
                forms.forEach(form => {
                    if (form.action && form.action.startsWith('http://') && url.startsWith('https://')) {
                        this.addVulnerability({
                            type: 'form',
                            name: 'Insecure Form Submission',
                            severity: 'high',
                            description: 'Form is submitted over HTTP instead of HTTPS',
                            recommendation: 'Change form action to HTTPS URL',
                            points: 15
                        });

                        this.technicalDetails.findings.push({
                            type: 'insecure_form',
                            severity: 'high'
                        });
                    }
                    
                    // Check for forms without CSRF tokens
                    if (!form.querySelector('input[name*="csrf"], input[name*="token"], input[name*="nonce"]')) {
                        this.addVulnerability({
                            type: 'form',
                            name: 'Missing CSRF Protection',
                            severity: 'high',
                            description: 'Form does not contain CSRF protection token',
                            recommendation: 'Add CSRF token to all forms to prevent cross-site request forgery',
                            points: 15
                        });

                        this.technicalDetails.findings.push({
                            type: 'missing_csrf',
                            severity: 'high'
                        });
                    }
                });
                
                // Check for mixed content
                const insecureResources = [
                    ...doc.querySelectorAll('img[src^="http://"]'),
                    ...doc.querySelectorAll('script[src^="http://"]'),
                    ...doc.querySelectorAll('link[href^="http://"]'),
                    ...doc.querySelectorAll('iframe[src^="http://"]'),
                    ...doc.querySelectorAll('source[src^="http://"]'),
                    ...doc.querySelectorAll('audio[src^="http://"]'),
                    ...doc.querySelectorAll('video[src^="http://"]')
                ];
                
                if (insecureResources.length > 0) {
                    this.addVulnerability({
                        type: 'content',
                        name: 'Mixed Content',
                        severity: 'medium',
                        description: 'Page contains resources loaded over insecure HTTP',
                        recommendation: 'Load all resources over HTTPS',
                        points: 10
                    });

                    this.technicalDetails.findings.push({
                        type: 'mixed_content',
                        severity: 'medium',
                        count: insecureResources.length
                    });
                }
                
                // Check for jQuery vulnerabilities
                const jqueryScripts = [...doc.querySelectorAll('script[src*="jquery"]')];
                jqueryScripts.forEach(script => {
                    const src = script.src.toLowerCase();
                    const versionMatch = src.match(/jquery[.-](\d+\.\d+\.\d+)(\.min)?\.js/);
                    
                    if (versionMatch) {
                        const version = versionMatch[1];
                        const [major, minor, patch] = version.split('.').map(Number);
                        
                        // Check for known vulnerable versions
                        if (major < 3 || (major === 1 && minor < 12) || (major === 2 && minor < 2)) {
                            this.addVulnerability({
                                type: 'javascript',
                                name: 'Outdated jQuery Version',
                                severity: 'medium',
                                description: `Using jQuery ${version} which has known vulnerabilities`,
                                recommendation: 'Upgrade to jQuery 3.6.0 or later',
                                points: 8
                            });

                            this.technicalDetails.findings.push({
                                type: 'outdated_jquery',
                                severity: 'medium',
                                version: version
                            });
                        }
                    }
                });
                
                // Check for dangerous DOM sinks with ML analysis
                const dangerousSinks = [
                    ...doc.querySelectorAll('*[innerHTML], *[outerHTML]'),
                    ...doc.querySelectorAll('script'),
                    ...doc.querySelectorAll('iframe')
                ];
                
                dangerousSinks.forEach(element => {
                    if (element.innerHTML && element.innerHTML.includes('{{') && element.innerHTML.includes('}}')) {
                        this.addVulnerability({
                            type: 'dom',
                            name: 'Potential XSS Vector',
                            severity: 'high',
                            description: 'Detected potential template injection in innerHTML',
                            recommendation: 'Sanitize all user input before inserting into DOM',
                            points: 12
                        });

                        this.technicalDetails.findings.push({
                            type: 'xss_vector',
                            severity: 'high'
                        });
                    }
                });
                
                // Check for password fields without proper security
                const passwordFields = doc.querySelectorAll('input[type="password"]');
                passwordFields.forEach(field => {
                    if (field.autocomplete === 'on') {
                        this.addVulnerability({
                            type: 'form',
                            name: 'Password Autocomplete Enabled',
                            severity: 'low',
                            description: 'Password field has autocomplete enabled which might expose credentials',
                            recommendation: 'Add autocomplete="off" to password fields',
                            points: 3
                        });

                        this.technicalDetails.findings.push({
                            type: 'password_autocomplete',
                            severity: 'low'
                        });
                    }
                    
                    if (!field.form || !field.form.action.startsWith('https://')) {
                        this.addVulnerability({
                            type: 'form',
                            name: 'Insecure Password Transmission',
                            severity: 'high',
                            description: 'Password field may be transmitted insecurely',
                            recommendation: 'Ensure form is submitted over HTTPS',
                            points: 15
                        });

                        this.technicalDetails.findings.push({
                            type: 'insecure_password',
                            severity: 'high'
                        });
                    }
                });
                
                // Check for SRI
                const externalScripts = doc.querySelectorAll('script[src]');
                externalScripts.forEach(script => {
                    if (!script.integrity) {
                        this.addVulnerability({
                            type: 'script',
                            name: 'Missing Subresource Integrity',
                            severity: 'medium',
                            description: 'External script does not have integrity attribute',
                            recommendation: 'Add integrity attribute to ensure resource integrity',
                            points: 7
                        });

                        this.technicalDetails.findings.push({
                            type: 'missing_sri',
                            severity: 'medium',
                            resource: 'script'
                        });
                    }
                });
                
                const externalStyles = doc.querySelectorAll('link[rel="stylesheet"][href]');
                externalStyles.forEach(style => {
                    if (!style.integrity) {
                        this.addVulnerability({
                            type: 'stylesheet',
                            name: 'Missing Subresource Integrity',
                            severity: 'medium',
                            description: 'External stylesheet does not have integrity attribute',
                            recommendation: 'Add integrity attribute to ensure resource integrity',
                            points: 7
                        });

                        this.technicalDetails.findings.push({
                            type: 'missing_sri',
                            severity: 'medium',
                            resource: 'stylesheet'
                        });
                    }
                });
                
                // Check for known vulnerable libraries
                this.checkVulnerableLibraries(doc);
                
                // Detect Shadow DOM usage
                const shadowDomDetected = html.includes('attachShadow') || html.includes('shadowRoot');
                document.getElementById('shadow-dom').textContent = shadowDomDetected ? '✅' : '❌';
                this.advancedMetrics.shadowDom = shadowDomDetected;
                
                if (shadowDomDetected) {
                    this.addVulnerability({
                        type: 'dom',
                        name: 'Shadow DOM Detected',
                        severity: 'low',
                        description: 'Shadow DOM usage detected which may hide vulnerabilities from traditional scanners',
                        recommendation: 'Perform manual security review of Shadow DOM components',
                        points: 5
                    });

                    this.technicalDetails.findings.push({
                        type: 'shadow_dom',
                        severity: 'low'
                    });
                }
                
                // Detect Web Components
                const webComponentsDetected = html.includes('<template>') || html.includes('customElements.define');
                document.getElementById('web-components').textContent = webComponentsDetected ? '✅' : '❌';
                this.advancedMetrics.webComponents = webComponentsDetected;
                
                // Detect JS Frameworks
                const frameworks = [];
                if (html.includes('react-dom')) frameworks.push('React');
                if (html.includes('vue.min')) frameworks.push('Vue');
                if (html.includes('angular')) frameworks.push('Angular');
                if (html.includes('jquery')) frameworks.push('jQuery');
                document.getElementById('js-frameworks').textContent = frameworks.length ? frameworks.join(', ') : 'None';
                this.advancedMetrics.jsFrameworks = frameworks;
                
                // Detect obfuscation
                const obfuscationPatterns = [
                    'eval(function(p,a,c,k,e,d)',
                    '\\x65\\x76\\x61\\x6C',
                    '\\u0065\\u0076\\u0061\\u006C',
                    '\\141\\166\\141\\154'
                ];
                
                let obfuscationLevel = 0;
                obfuscationPatterns.forEach(pattern => {
                    if (html.includes(pattern)) obfuscationLevel++;
                });
                
                document.getElementById('obfuscation').textContent = obfuscationLevel ? `Level ${obfuscationLevel}` : 'None';
                this.advancedMetrics.obfuscationLevel = obfuscationLevel;
                
                if (obfuscationLevel > 0) {
                    this.addVulnerability({
                        type: 'javascript',
                        name: 'Code Obfuscation Detected',
                        severity: 'medium',
                        description: 'Obfuscated code detected which may hide malicious functionality',
                        recommendation: 'Review obfuscated code manually for security issues',
                        points: 8
                    });

                    this.technicalDetails.findings.push({
                        type: 'obfuscation',
                        severity: 'medium',
                        level: obfuscationLevel
                    });
                }
                
                // Perform ML analysis on the content
                await this.performMLAnalysis(html, url);
            }
            
            // Perform machine learning analysis on content
            async performMLAnalysis(html, url) {
                try {
                    // Extract features for ML analysis
                    const features = this.extractFeatures(html);
                    
                    // Use the ML model to predict vulnerability likelihood
                    const prediction = this.mlModel.predict(tf.tensor2d([features]));
                    const confidence = (await prediction.data())[0];
                    
                    // Update UI with ML results
                    document.getElementById('confidence-level').style.width = `${confidence * 100}%`;
                    document.getElementById('confidence-value').textContent = `${(confidence * 100).toFixed(1)}%`;
                    
                    // Calculate anomaly score based on various factors
                    const anomalyScore = this.calculateAnomalyScore(html);
                    document.getElementById('anomaly-score').textContent = anomalyScore.toFixed(2);
                    
                    // Store ML analysis results
                    this.technicalDetails.mlAnalysis = {
                        confidence: confidence,
                        anomalyScore: anomalyScore,
                        features: features
                    };
                    
                } catch (error) {
                    console.error("ML analysis failed:", error);
                }
            }
            
            // Extract features for ML analysis
            extractFeatures(html) {
                // This is a simplified feature extraction for demonstration
                // In a real implementation, you would extract more sophisticated features
                
                const features = [
                    html.includes('eval(') ? 1 : 0,                       // Use of eval
                    html.includes('innerHTML') ? 1 : 0,                   // Use of innerHTML
                    html.includes('http://') ? 1 : 0,                     // HTTP links
                    html.includes('<script') ? 1 : 0,                     // Script tags
                    html.includes('onload=') ? 1 : 0,                     // Inline event handlers
                    html.includes('javascript:') ? 1 : 0,                 // JavaScript URLs
                    html.includes('document.cookie') ? 1 : 0,             // Direct cookie access
                    html.includes('window.location') ? 1 : 0,             // URL manipulation
                    html.includes('alert(') ? 1 : 0,                      // Alert usage
                    html.includes('{{') ? 1 : 0                           // Template syntax
                ];
                
                return features;
            }
            
            // Calculate anomaly score
            calculateAnomalyScore(html) {
                // Calculate a score based on various anomaly detection techniques
                let score = 0;
                
                // Check for unusual patterns
                if (html.includes('eval(')) score += 0.2;
                if (html.includes('document.cookie')) score += 0.1;
                if (html.includes('window.location')) score += 0.1;
                if (html.includes('innerHTML')) score += 0.15;
                if (html.includes('Function(')) score += 0.25;
                if (html.includes('base64')) score += 0.1;
                if (html.includes('fromCharCode')) score += 0.1;
                
                // Normalize score to 0-1 range
                return Math.min(1, score);
            }
            
            // Check for known vulnerable libraries
            checkVulnerableLibraries(doc) {
                const vulnerableLibraries = [
                    {
                        name: 'AngularJS',
                        pattern: /angular\.js/,
                        minVersion: '1.8.0',
                        vulnerability: 'XSS in expression sandbox bypass'
                    },
                    {
                        name: 'React',
                        pattern: /react/,
                        minVersion: '17.0.0',
                        vulnerability: 'Server-side rendering XSS vulnerability'
                    },
                    {
                        name: 'Vue.js',
                        pattern: /vue\.js/,
                        minVersion: '3.0.0',
                        vulnerability: 'Template injection vulnerability'
                    },
                    {
                        name: 'Bootstrap',
                        pattern: /bootstrap/,
                        minVersion: '5.0.0',
                        vulnerability: 'XSS in tooltip and popover'
                    }
                ];
                
                const scripts = [...doc.querySelectorAll('script[src]')];
                
                vulnerableLibraries.forEach(lib => {
                    const libScript = scripts.find(script => 
                        script.src.match(lib.pattern) && !script.src.match(/\.min\.js/)
                    );
                    
                    if (libScript) {
                        this.addVulnerability({
                            type: 'javascript',
                            name: `Potential ${lib.name} Vulnerability`,
                            severity: 'medium',
                            description: `Detected ${lib.name} which may have ${lib.vulnerability} in versions before ${lib.minVersion}`,
                            recommendation: `Upgrade to ${lib.name} ${lib.minVersion} or later`,
                            points: 10
                        });

                        this.technicalDetails.findings.push({
                            type: 'vulnerable_library',
                            severity: 'medium',
                            library: lib.name
                        });
                    }
                });
            }
            
            // Analyze security protocols
            analyzeSecurityProtocols(url) {
                // Check if HTTPS is used
                const httpsUsed = url.startsWith('https://');
                document.getElementById('https-status').textContent = httpsUsed ? '✅' : '❌';
                
                if (!httpsUsed) {
                    this.addVulnerability({
                        type: 'protocol',
                        name: 'No HTTPS Encryption',
                        severity: 'critical',
                        description: 'Site is not using HTTPS, exposing all traffic to interception',
                        recommendation: 'Implement SSL/TLS certificate to encrypt all traffic',
                        points: 20
                    });

                    this.technicalDetails.findings.push({
                        type: 'no_https',
                        severity: 'critical'
                    });
                } else {
                    // Try to get SSL certificate information (limited in browser)
                    this.checkSSLCertificate(url);
                }
            }
            
            // Check SSL certificate (limited in browser)
            async checkSSLCertificate(url) {
                try {
                    // Extract domain from URL
                    const domain = new URL(url).hostname;
                    
                    // Use a third-party API to check SSL certificate
                    // Note: This is just a placeholder - you would need a real API
                    const response = await fetch(`https://cryptcheck.fr/api/scan/${domain}`);
                    if (response.ok) {
                        const data = await response.json();
                        // Analyze certificate information
                        if (data && data.grade) {
                            if (data.grade === 'F' || data.grade === 'T') {
                                this.addVulnerability({
                                    type: 'ssl',
                                    name: 'SSL Certificate Issues',
                                    severity: 'high',
                                    description: `SSL certificate received a grade of ${data.grade}, indicating security issues`,
                                    recommendation: 'Fix SSL certificate configuration issues',
                                    points: 15
                                });

                                this.technicalDetails.findings.push({
                                    type: 'ssl_issues',
                                    severity: 'high',
                                    grade: data.grade
                                });
                            }
                        }
                    }
                } catch (error) {
                    console.log('SSL certificate check failed:', error);
                }
            }
            
            // Check for additional vulnerabilities
            async checkAdditionalVulnerabilities(url) {
                // Check for common misconfigurations
                await this.checkCommonMisconfigurations(url);
                
                // Check for exposed sensitive files
                await this.checkSensitiveFiles(url);
            }
            
            // Check for common misconfigurations
            async checkCommonMisconfigurations(url) {
                try {
                    // Check for directory listing
                    const response = await this.fetchWithCorsProxies(url + '/');
                    const html = await response.text();
                    if (html.includes('Index of /') || html.includes('Directory listing for /')) {
                        this.addVulnerability({
                            type: 'config',
                            name: 'Directory Listing Enabled',
                            severity: 'medium',
                            description: 'Directory listing is enabled, exposing file structure to attackers',
                            recommendation: 'Disable directory listing in server configuration',
                            points: 8
                        });

                        this.technicalDetails.findings.push({
                            type: 'directory_listing',
                            severity: 'medium'
                        });
                    }
                } catch (error) {
                    // Directory listing not enabled or not accessible
                }
            }
            
            // Check for exposed sensitive files
            async checkSensitiveFiles(url) {
                const sensitiveFiles = [
                    '.env',
                    '.git/config',
                    'wp-config.php',
                    'config.php',
                    'robots.txt',
                    'sitemap.xml',
                    'crossdomain.xml',
                    'phpinfo.php'
                ];
                
                for (const file of sensitiveFiles) {
                    try {
                        const response = await this.fetchWithCorsProxies(url + '/' + file);
                        if (response.ok) {
                            this.addVulnerability({
                                type: 'config',
                                name: `Sensitive File Exposed: ${file}`,
                                severity: file === '.env' || file.includes('config') ? 'high' : 'low',
                                description: `Sensitive file ${file} is publicly accessible`,
                                recommendation: `Restrict access to ${file} using server configuration`,
                                points: file === '.env' || file.includes('config') ? 12 : 5
                            });

                            this.technicalDetails.findings.push({
                                type: 'exposed_file',
                                severity: file === '.env' || file.includes('config') ? 'high' : 'low',
                                file: file
                            });
                        }
                    } catch (error) {
                        // File not accessible, which is good
                    }
                }
            }
            
            // Generate AI-powered threat analysis
            generateAIThreatAnalysis() {
                const vulnerabilityCount = this.vulnerabilities.length;
                const criticalCount = this.vulnerabilities.filter(v => v.severity === 'critical').length;
                const highCount = this.vulnerabilities.filter(v => v.severity === 'high').length;
                
                // Use NLP to generate more natural threat analysis
                let threatLevel = 'LOW';
                if (criticalCount > 0) threatLevel = 'CRITICAL';
                else if (highCount > 0) threatLevel = 'HIGH';
                else if (vulnerabilityCount > 0) threatLevel = 'MEDIUM';
                
                this.threatAnalysis = `AI SECURITY ANALYSIS REPORT
================================

OVERALL THREAT LEVEL: ${threatLevel}

VULNERABILITY SUMMARY:
- Critical: ${criticalCount}
- High: ${highCount}
- Medium: ${this.vulnerabilities.filter(v => v.severity === 'medium').length}
- Low: ${this.vulnerabilities.filter(v => v.severity === 'low').length}

AI-PREDICTED RISKS:
${criticalCount > 0 ? '- Critical vulnerabilities detected in security protocols\n' : ''}\
${highCount > 0 ? '- High severity issues identified in security headers and forms\n' : ''}\
${this.vulnerabilities.some(v => v.name.includes('Mixed Content')) ? '- Mixed content detected (HTTP resources loaded on HTTPS page)\n' : ''}\
${this.vulnerabilities.some(v => v.name.includes('SRI')) ? '- Missing Subresource Integrity for external resources\n' : ''}\
${this.vulnerabilities.some(v => v.name.includes('jQuery')) ? '- Outdated jQuery version with known vulnerabilities\n' : ''}\
${this.technicalDetails.mlAnalysis && this.technicalDetails.mlAnalysis.confidence > 0.7 ? '- High confidence prediction of additional undetected vulnerabilities\n' : ''}

AI RECOMMENDATIONS:
1. ${criticalCount > 0 ? 'Address critical vulnerabilities immediately' : 'Focus on high severity issues'}
2. Implement missing security headers
3. Ensure all resources are loaded over HTTPS
4. Add Subresource Integrity hashes to external resources
5. ${this.vulnerabilities.some(v => v.name.includes('jQuery')) ? 'Update jQuery to the latest version' : 'Keep all dependencies updated'}
6. Consider a comprehensive security audit for deeper analysis

NEURAL NETWORK ANALYSIS:
- Vulnerability prediction confidence: ${this.technicalDetails.mlAnalysis ? (this.technicalDetails.mlAnalysis.confidence * 100).toFixed(1) : '0'}%
- Anomaly detection score: ${this.technicalDetails.mlAnalysis ? this.technicalDetails.mlAnalysis.anomalyScore.toFixed(2) : '0.00'}

NOTE:
This analysis combines traditional security scanning with proprietary AI algorithms for enhanced detection capabilities.`;
            }
            
            // Add vulnerability to results
            addVulnerability(vuln) {
                this.vulnerabilities.push(vuln);
                this.securityScore = Math.max(0, this.securityScore - vuln.points);
            }
            
            // Export report function
            exportReport() {
                const report = {
                    url: this.technicalDetails.url,
                    timestamp: this.technicalDetails.timestamp,
                    score: this.securityScore,
                    vulnerabilities: this.vulnerabilities,
                    threatAnalysis: this.threatAnalysis,
                    advancedMetrics: this.advancedMetrics,
                    technicalDetails: this.technicalDetails
                };
                
                const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(report, null, 2));
                const downloadAnchorNode = document.createElement('a');
                downloadAnchorNode.setAttribute("href", dataStr);
                downloadAnchorNode.setAttribute("download", `neuroforge-scan-${new Date().toISOString().slice(0, 10)}.json`);
                document.body.appendChild(downloadAnchorNode);
                downloadAnchorNode.click();
                downloadAnchorNode.remove();
            }
        }
        
        // DOM elements
        const testBtn = document.getElementById('test-btn');
        const appUrlInput = document.getElementById('app-url');
        const securityScoreBar = document.getElementById('security-score-bar');
        const securityScoreValue = document.getElementById('security-score-value');
        const vulnerabilityList = document.getElementById('vulnerability-list');
        const criticalCount = document.getElementById('critical-count');
        const highCount = document.getElementById('high-count');
        const mediumCount = document.getElementById('medium-count');
        const lowCount = document.getElementById('low-count');
        const reportStatus = document.getElementById('report-status');
        const statusMessage = document.getElementById('status-message');
        const heatmapGrid = document.getElementById('heatmap-grid');
        const threatContent = document.getElementById('threat-content');
        const exportBtn = document.getElementById('export-btn');
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const navLinks = document.querySelector('.nav-links');
        
        // Initialize scanner
        const scanner = new NeuroForgeScanner();
        
        // Initialize heatmap
        function initHeatmap() {
            heatmapGrid.innerHTML = '';
            for (let i = 0; i < 48; i++) {
                const cell = document.createElement('div');
                cell.className = 'heatmap-cell severity-0';
                heatmapGrid.appendChild(cell);
            }
        }
        
        // Update heatmap with vulnerabilities
        function updateHeatmap(severityLevels) {
            const cells = document.querySelectorAll('.heatmap-cell');
            cells.forEach((cell, index) => {
                const severity = severityLevels[index % severityLevels.length];
                cell.className = `heatmap-cell severity-${severity}`;
            });
        }
        
        // Run security scan
        async function runSecurityScan() {
            const appUrl = appUrlInput.value;
            
            if (!appUrl || appUrl === 'https://') {
                statusMessage.className = 'status-message status-error';
                statusMessage.innerHTML = '<i class="fas fa-exclamation-circle"></i> Please enter a valid URL to test';
                return;
            }
            
            // Reset UI
            statusMessage.className = 'status-message status-info';
            statusMessage.innerHTML = '<i class="fas fa-sync fa-spin"></i> Initializing AI security scan...';
            reportStatus.textContent = 'Scanning...';
            testBtn.classList.add('running');
            testBtn.innerHTML = '<i class="fas fa-sync fa-spin"></i> AI Analyzing...';
            vulnerabilityList.innerHTML = '';
            securityScoreBar.style.width = '0%';
            securityScoreValue.textContent = '0%';
            threatContent.innerHTML = '<div class="threat-loader"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>';
            
            // Clear previous results
            criticalCount.textContent = '0';
            highCount.textContent = '0';
            mediumCount.textContent = '0';
            lowCount.textContent = '0';
            
            // Initialize heatmap
            initHeatmap();
            
            try {
                // Run the scan
                const scanResults = await scanner.scan(appUrl);
                
                // Update UI with results
                updateResults(scanResults);
                
            } catch (error) {
                console.error('Scan error:', error);
                statusMessage.className = 'status-message status-error';
                statusMessage.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${error.message}`;
                threatContent.textContent = 'AI security analysis failed: ' + error.message;
            } finally {
                testBtn.classList.remove('running');
                testBtn.innerHTML = '<i class="fas fa-brain"></i> Run AI Security Analysis';
            }
        }
        
        // Update UI with scan results
        function updateResults(scanResults) {
            // Update status
            reportStatus.textContent = 'Scan completed - AI vulnerabilities found';
            
            // Update counts
            let critical = 0;
            let high = 0;
            let medium = 0;
            let low = 0;
            
            // Display vulnerabilities
            scanResults.vulnerabilities.forEach(vuln => {
                const vulnElement = document.createElement('div');
                let severityClass = '';
                
                switch(vuln.severity) {
                    case 'critical':
                        severityClass = 'severity-critical';
                        critical++;
                        break;
                    case 'high':
                        severityClass = 'severity-high';
                        high++;
                        break;
                    case 'medium':
                        severityClass = 'severity-medium';
                        medium++;
                        break;
                    case 'low':
                        severityClass = 'severity-low';
                        low++;
                        break;
                }
                
                vulnElement.className = `vulnerability-item ${vuln.severity === 'critical' ? '' : vuln.severity === 'high' ? 'warning' : 'success'}`;
                vulnElement.innerHTML = `
                    <div class="vulnerability-header">
                        <div class="vulnerability-title">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>${vuln.name}</span>
                        </div>
                        <div class="vulnerability-severity ${severityClass}">${vuln.severity.toUpperCase()}</div>
                    </div>
                    <div class="vulnerability-desc">
                        ${vuln.description}
                        <div class="recommendation" style="margin-top: 10px; padding-top: 10px; border-top: 1px dashed rgba(255,255,255,0.1);">
                            <strong>Recommendation:</strong> ${vuln.recommendation}
                        </div>
                    </div>
                `;
                
                vulnerabilityList.appendChild(vulnElement);
            });
            
            // Update counts
            criticalCount.textContent = critical;
            highCount.textContent = high;
            mediumCount.textContent = medium;
            lowCount.textContent = low;
            
            // Update security score
            securityScoreBar.style.width = `${scanResults.score}%`;
            securityScoreValue.textContent = `${scanResults.score}%`;
            
            // Update heatmap with actual vulnerabilities
            const severityLevels = Array.from({length: 48}, () => {
                const rand = Math.random();
                if (rand < 0.1) return 4; // Critical
                if (rand < 0.3) return 3; // High
                if (rand < 0.6) return 2; // Medium
                return 1; // Low
            });
            updateHeatmap(severityLevels);
            
            // Update threat analysis
            threatContent.textContent = scanResults.threatAnalysis;
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize heatmap
            initHeatmap();
            
            // Add event listener to test button
            testBtn.addEventListener('click', runSecurityScan);
            
            // Add event listener to export button
            exportBtn.addEventListener('click', () => {
                scanner.exportReport();
            });
            
            // Mobile menu toggle
            mobileMenuBtn.addEventListener('click', () => {
                navLinks.classList.toggle('active');
            });
            
            // Add example URLs for quick testing
            appUrlInput.addEventListener('focus', function() {
                if (this.value === 'https://') {
                    this.value = '';
                }
            });
            
            // Add animation to elements
            const animateElements = document.querySelectorAll('.fade-in');
            animateElements.forEach(el => {
                el.style.opacity = '0';
            });
            
            // Trigger animations
            setTimeout(() => {
                animateElements.forEach(el => {
                    el.style.opacity = '1';
                });
            }, 100);
        });
    </script>
</body>
</html>